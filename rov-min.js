const prevButtonHTML='<div class="previous w-slider-arrow-left" role="button" tabindex="0" aria-controls="w-slider-mask-0" aria-label="previous slide" style="display: none;"><div id="prevButton" class="previous-button">← Back</div></div>',nextButtonHTML='<div class="next roviniete w-slider-arrow-right" role="button" tabindex="0" aria-controls="w-slider-mask-0" aria-label="next slide" style="top: -468.516px;"><div id="nextButton" class="next-button button">Continua</div></div>';var removedCategoryRowsNoTimes=0;const base_url_mobilpay="https://app.autodeal.ro",base_url="https://app.autodeal.ro/api/v1",token="113701|STygD85xaZB20zgdeOGtJXM5q2NX6bpwmIQ5JRxB",errorColor="hsl(350 100% 13.5%)",errorBg="hsl(350 100% 66.5%)";var categories=[],availabilities=[];const images={"A-Autoturism":"https://uploads-ssl.webflow.com/60b35cb1a44c2d844c8e31f9/6332e5866e57b7cee8f870d5_sedan%201.png","B-Mf 0,0t<MTMA<=3,5t":"https://uploads-ssl.webflow.com/60b35cb1a44c2d844c8e31f9/6332e586ea937c33d185a284_delivery-truck%201.png"};function removeRadiochildrenOnce(e){if(removedCategoryRowsNoTimes>=1)return;let t=document.getElementById(e);for(let a of[...t.children])a.innerHTML.includes("radio-button-label-2")&&t.removeChild(a);"category-table"===e&&(removedCategoryRowsNoTimes+=1)}function getVignetteCategories(){var e=new XMLHttpRequest;e.open("GET",`${base_url}/vignette-categories`,!1),e.setRequestHeader("Authorization",`Bearer ${token}`),e.onload=function(){var t=JSON.parse(this.response);e.status>=200&&e.status<400&&(categories=t.data)},e.send()}function getVignetteCategoryPrices(e){var t=new XMLHttpRequest;t.open("GET",`${base_url}/vignette-categories/${e}/prices`,!1),t.setRequestHeader("Authorization",`Bearer ${token}`),t.onload=function(){var e=JSON.parse(this.response);t.status>=200&&t.status<400&&(availabilities=e.data,addPrices())},t.send()}function addNextPrevButtonsAsChildOfId(e){let t=document.getElementById(e);t.innerHTML.includes(prevButtonHTML)||(t.innerHTML+=prevButtonHTML),t.innerHTML.includes(nextButtonHTML)||(t.innerHTML+=nextButtonHTML)}function removeNextPrevButtonsAsChildOfId(e){let t=document.getElementById(e);t.innerHTML.includes(prevButtonHTML)&&(t.innerHTML=t.innerHTML.replace(prevButtonHTML,"")),t.innerHTML.includes(nextButtonHTML)&&(t.innerHTML=t.innerHTML.replace(nextButtonHTML,""))}function addCategoriesRow(){let e=document.getElementById("category-table");var t=document.createElement("div");addClass(t,"rov-row"),addClass(t,"w-clearfix");for(let a=0;a<categories.length;a++){a%4==0&&0!=a&&(e.appendChild(t),addClass(t=document.createElement("div"),"rov-row"),addClass(t,"w-clearfix"));var r=categories[a],s=document.createElement("div");addClass(s,"input-group input-fullwidth rovinieta-input");var n=document.createElement("div");addClass(n,"extra-option-wrap");var i=document.createElement("label");addClass(i,"radio-button-field-2 w-clearfix w-radio");var l=document.createElement("img");addClass(l,"image-17"),l.setAttribute("src",images[r.code]),l.setAttribute("loading","lazy"),l.setAttribute("width","64"),l.setAttribute("alt",r.name);var o=document.createElement("div");addClass(o,"w-form-formradioinput w-form-formradioinput--inputType-custom radio-button-2 align-right w-radio-input"),"A-Autoturism"==r.code&&(addClass(o,"w--redirected-checked"),localStorage.setItem("selectedCategory",r.id));var d=document.createElement("input");d.setAttribute("type","radio"),d.setAttribute("name","auto"),d.setAttribute("data-name","auto"),d.setAttribute("style","opacity:0;position:absolute;z-index:-1"),d.setAttribute("value",r.id),d.setAttribute("id","auto"+a);var u=document.createElement("span");addClass(u,"radio-button-label-2 radio-image w-form-label"),u.setAttribute("for","auto"+a);var p=document.createElement("strong");addClass(p,"bold-text-3"),p.innerHTML=r.name,u.appendChild(p),i.appendChild(l),i.appendChild(o),i.appendChild(d),i.appendChild(u),i.addEventListener("click",function(e){"radio"==e.target.type&&localStorage.setItem("selectedCategory",e.target.value)}),n.appendChild(i),s.appendChild(n),t.appendChild(s)}e.appendChild(t)}function removeSuccess(e=0){setTimeout(function(){null!=(container=document.getElementById("successMessageSubmit"))&&(container.style.display="none",(form=document.getElementById("wf-form-rovinieta-detalii")).style.display="block")},1e3*e)}function addPrices(){let e=document.getElementById("rovList");e.innerHTML="";var t=document.createElement("div");addClass(t,"w-clearfix");for(let a=0;a<availabilities.length;a++){var r=availabilities[a],s=document.createElement("div");addClass(s,"input-group input-fullwidth rovinieta-input");var n=document.createElement("div");addClass(n,"extra-option-wrap");var i=document.createElement("label");addClass(i,"radio-button-field-2 fullwidth w-clearfix w-radio");var l=document.createElement("div");addClass(l,"w-form-formradioinput w-form-formradioinput--inputType-custom radio-button-2 w-radio-input"),0==a&&(addClass(l,"w--redirected-checked"),localStorage.setItem("selectedAvailability",r.availability_code));var o=document.createElement("input");o.setAttribute("type","radio"),o.setAttribute("name","availability"),o.setAttribute("data-name","availability"),o.setAttribute("style","opacity:0;position:absolute;z-index:-1"),o.setAttribute("value",r.availability_code),o.setAttribute("id","availability"+a);var d=document.createElement("span");addClass(d,"radio-button-label-2 radio-button-label-3 w-form-label"),d.setAttribute("for","availability"+a);var u=document.createElement("strong");addClass(u,"bold-text-3"),u.innerHTML=r.availability_name,d.appendChild(u);var p=document.createElement("div");addClass(p,"div-block-13");var c=document.createElement("div");addClass(c,"text-block-13"),c.innerHTML=r.value+" "+r.currency_code;var m=document.createElement("div");addClass(m,"eur"),m.innerHTML=r.authority_value+" "+r.authority_currency_code,p.appendChild(c),p.appendChild(m),i.appendChild(l),i.appendChild(o),i.appendChild(d),i.appendChild(p),i.addEventListener("click",function(e){"radio"==e.target.type&&localStorage.setItem("selectedAvailability",e.target.value)}),n.appendChild(i),s.appendChild(n),t.appendChild(s)}e.appendChild(t)}let toastContainer;function generateToast({message:e,background:t="#00214d",color:a="#fffffe",length:r="3000ms"}){toastContainer.insertAdjacentHTML("beforeend",`<p class="toast" 
    style="background-color: ${t};
    color: ${a};
    animation-duration: ${r}">
    ${e}
  </p>`);let s=toastContainer.lastElementChild;s.addEventListener("animationend",()=>s.remove())}function initToast(){document.body.insertAdjacentHTML("afterbegin",`<div class="toast-container"></div>
  <style>
  .toast-container{position:fixed;z-index:10000;top:8rem;right:1.5rem;display:grid;justify-items:end;gap:.5rem}.toast{line-height:1;padding:.5em 1em;animation:toastIt 7000ms cubic-bezier(.785,.135,.15,.86) forwards;border-radius:4px;font-size:12px;font-weight:400;background:hsl(0,0%,91.8%)!important}@keyframes toastIt{0%,100%{transform:translateY(-150%);opacity:0}10%,90%{transform:translateY(0);opacity:1}}@media screen and (max-width:991px){.toast-container{justify-items:center;background:#fff;width:100%}.toast-container .toast{margin-top:1em}}
  </style>
  `),toastContainer=document.querySelector(".toast-container")}function handleSubmit(e){e.preventDefault();let t=localStorage.getItem("license-number"),a=localStorage.getItem("selectedAvailability"),r=new FormData(e.target);r.append("availability",a),r.append("registration_number",t);let s=new URLSearchParams(r);s.delete("_redirect"),localStorage.setItem("querystring2",s.toString());let n=localStorage.getItem("querystring2");postVignetteAllData("card",n),removeSuccess(5)}function hasClass(e,t){return RegExp("(\\s|^)"+t+"(\\s|$)").exec(e.className)}function addClass(e,t){hasClass(e,t)||(e.className+=" "+t)}function removeClass(e,t){if(hasClass(e,t)){var a=RegExp("(\\s|^)"+t+"(\\s|$)");e.className=e.className.replace(a," ")}}function goToPreviousStep(){let e="step-active",t=document.getElementById("pasText"),a=document.getElementById("pasTextAlt"),r=document.getElementById("step1"),s=document.getElementById("step2"),n=document.getElementById("step3"),i=document.getElementById("step1alt"),l=document.getElementById("step2alt"),o=document.getElementById("step3alt"),d=document.getElementById("nextBtnWrapperRov"),u=document.getElementById("prevBtnWrapperRov");switch(t.innerHTML){case"Pasul 1":break;case"Pasul 2":document.getElementById("nextButton").innerHTML="Continuă la selectarea rovinietei",addClass(r,e),removeClass(s,e),removeClass(n,e),addClass(i,e),removeClass(l,e),removeClass(o,e),t.innerHTML="Pasul 1",a.innerHTML="Pasul 1",removeClass(d,"slider2"),addClass(d,"slider1"),removeClass(u,"slider2"),addClass(u,"slider1"),$(window).scrollTop(0);break;case"Pasul 3":document.getElementById("nextButton").innerHTML="Continuă la detalii proprietar",removeClass(r,e),addClass(s,e),removeClass(n,e),removeClass(i,e),addClass(l,e),removeClass(o,e),t.innerHTML="Pasul 2",a.innerHTML="Pasul 2",hasClass(d,"slider2")||(addClass(d,"slider2"),removeClass(d,"slider1")),hasClass(u,"slider2")||(addClass(u,"slider2"),removeClass(u,"slider1")),removeClass(u,"slider3"),$(window).scrollTop(0)}}function goToNextStep(e){let t="step-active",a=document.getElementById("pasText"),r=document.getElementById("pasTextAlt"),s=document.getElementById("step1"),n=document.getElementById("step2"),i=document.getElementById("step3"),l=document.getElementById("step1alt"),o=document.getElementById("step2alt"),d=document.getElementById("step3alt"),u=document.getElementById("nextBtnWrapperRov"),p=document.getElementById("prevBtnWrapperRov");switch(a.innerHTML){case"Pasul 1":getVignetteCategoryPrices(localStorage.getItem("selectedCategory")),document.getElementById("nextButton").innerHTML="Continuă la detalii proprietar",removeClass(s,t),addClass(n,t),removeClass(i,t),removeClass(l,t),addClass(o,t),removeClass(d,t),a.innerHTML="Pasul 2",r.innerHTML="Pasul 2",removeClass(u,"slider1"),addClass(u,"slider2"),removeClass(p,"slider1"),addClass(p,"slider2"),$(window).scrollTop(0);break;case"Pasul 2":if(""===document.getElementById("vin").value?.trim())return e.preventDefault(),generateToast({message:"Toate campurile trebuie completate",background:"hsl(350 100% 66.5%)",color:"hsl(350 100% 13.5%)"}),document.getElementById("pasText").innerHTML="Pasul 3",document.getElementById("prevButton").click(),!1;removeClass(s,t),removeClass(n,t),addClass(i,t),removeClass(l,t),removeClass(o,t),addClass(d,t),a.innerHTML="Pasul 3",r.innerHTML="Pasul 3",$(window).scrollTop(0),removeClass(p,"slider1"),removeClass(p,"slider2"),addClass(p,"slider3")}}function fadeOut(e){e.style.opacity=1,setTimeout(()=>{e.style.opacity=0},520)}function postVignetteAllData(e,t){var a=new XMLHttpRequest;console.log(t),a.open("POST",`${base_url}/vignette-policies/all-data?${t}`,!0),a.setRequestHeader("Authorization",`Bearer ${token}`),a.setRequestHeader("Content-Type","application/json"),a.onload=function(){var t=JSON.parse(this.response);console.log("postVignetteAllData"),console.log(t),a.status>=200&&a.status<400?("card"===e&&postMobilpay(t.data.order_id),"rate"===e&&postTbi(t.data.order_id)):(generateToast({message:t.error.pretty_message,background:errorBg,color:errorColor}),console.log("Error fetching offer data: "+t.error.pretty_message))},a.send()}function postMobilpay(e){var t=new XMLHttpRequest;t.open("POST",`${base_url}/payu/create?order_id=${e}`,!0),t.setRequestHeader("Authorization",`Bearer ${token}`),t.setRequestHeader("Content-Type","application/json"),t.onload=function(){var e=JSON.parse(this.response);console.log("postMobilpay"),console.log(e),t.status>=200&&t.status<400?getMobilpay(e.data.token):(generateToast({message:e.error.pretty_message,background:errorBg,color:errorColor}),console.log("Error fetching offer data: "+e.error.pretty_message))},t.send()}function postTbi(e,t=4){var a=new XMLHttpRequest;a.open("POST",`${base_url}/tbi/create?order_id=${e}&instalments=${t}`,!0),a.setRequestHeader("Authorization",`Bearer ${token}`),a.setRequestHeader("Content-Type","application/json"),a.onload=function(){var e=JSON.parse(this.response);a.status>=200&&a.status<400?getTbi(e.data.token):(generateToast({message:e.error.pretty_message,background:errorBg,color:errorColor}),console.log("Error fetching offer data: "+e.error.pretty_message))},a.send()}function getMobilpay(e){window.location.href=`${base_url_mobilpay}/payu?token=${e}`}function getTbi(e){window.location.href=`${base_url_mobilpay}/tbi?token=${e}`}function addCategoryToLocalStorage(e){localStorage.setItem("selectedCategory",e.target.value)}window.onload=function(){initToast(),addClass(document.getElementById("nextBtnWrapperRov"),"slider1"),addClass(document.getElementById("prevBtnWrapperRov"),"slider1"),document.getElementById("nextButton").innerHTML="Continuă la selectarea rovinietei",getVignetteCategories();let e=document.getElementById("wf-form-rovinieta-detalii");e.addEventListener("submit",handleSubmit);let t=document.getElementById("1");t.addEventListener("click",addCategoryToLocalStorage);let a=document.getElementById("2");a.addEventListener("click",addCategoryToLocalStorage),document.getElementById("1").click();let r=document.getElementById("start_date");r.flatpickr({altInput:!0,defaultDate:new Date,minDate:new Date,allowInput:!0,maxDate:new Date().setMonth(new Date().getMonth()+1),altFormat:"d.m.Y",dateFormat:"d.m.Y"});let s=document.getElementById("nextButton");s.addEventListener("click",goToNextStep);let n=document.getElementById("prevButton");n.addEventListener("click",goToPreviousStep)},console.log("V1-min");
